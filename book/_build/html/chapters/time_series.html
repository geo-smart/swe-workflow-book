
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Cumulative Time Series Analysis &#8212; Snow Water Equivalent Workflow</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chapters/time_series';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Sanity Checks" href="sanity_checks.html" />
    <link rel="prev" title="Feature Selection for SWE Prediction Models" href="feat_selection.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Snow Water Equivalent Workflow - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Snow Water Equivalent Workflow - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Chapter One</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="motivation.html">Motivation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Chapter Two</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview of the SWE Workflow</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Chapter Three</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="datasource.html">Training and Testing Dataset Overview</a></li>











<li class="toctree-l1"><a class="reference internal" href="gridmet.html">GridMET Climatology Data Downloader</a></li>


<li class="toctree-l1"><a class="reference internal" href="snotel.html">SNOTEL</a></li>
<li class="toctree-l1"><a class="reference internal" href="fsCA.html">MODIS for fsCA</a></li>
<li class="toctree-l1"><a class="reference internal" href="dem.html">Digital Elevation Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="amsr.html">AMSR</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Chapter Four</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="feat_selection.html">Feature Selection</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Chapter Five</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Cumulative Time series analysis</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Chapter Six</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="sanity_checks.html">Workflow Sanity Checks</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Chapter Seven</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="model_training.html">Model Training</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Chapter Eight</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="validation.html">Model Testing &amp; Validation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Chapter Nine</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="predictions.html">Model Predictions / Results</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Chapter Ten</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="conclusion.html">Conclusion</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../reference/glossary.html">Glossaries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/bibliography.html">Bibliography</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/geo-smart/use_case_template/main?urlpath=lab/tree/book/chapters/time_series.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/geo-smart/use_case_template" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/geo-smart/use_case_template/edit/main/book/chapters/time_series.ipynb" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/geo-smart/use_case_template/issues/new?title=Issue%20on%20page%20%2Fchapters/time_series.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/chapters/time_series.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Cumulative Time Series Analysis</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#program-execution-flow">Program Execution Flow</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#importing-the-libraries-and-input-files">Importing the libraries and Input files</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cleaning-and-preparation">Cleaning and Preparation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#clean-non-swe-rows">clean_non_swe_rows</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpolation-and-missing-data-handling">Interpolation and Missing Data Handling</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#interpolate-missing-inplace">interpolate_missing_inplace</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#conversion-to-time-series-format">Conversion to Time Series Format</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#convert-to-time-series">convert_to_time_series</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#addition-of-cumulative-columns">Addition of Cumulative Columns</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#add-cumulative-columns">add_cumulative_columns</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#execution-and-output">Execution and Output</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="cumulative-time-series-analysis">
<h1>Cumulative Time Series Analysis<a class="headerlink" href="#cumulative-time-series-analysis" title="Link to this heading">#</a></h1>
<p>Importance of time series analysis in SWE data
Methods and models for time series analysis</p>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading">#</a></h2>
<p>This chapter focus is on process and analyze Snow Water Equivalent (SWE) and meteorological data to prepare it for time series analysis. Addresses several key aspects of data preparation, including data cleaning, handling missing data, data interpolation, and transformation of data into a suitable format for analysis. The end goal is to facilitate the examination of SWE dynamics and related meteorological variables over time, enabling more accurate and insightful environmental and climatic analyses.</p>
</section>
<section id="program-execution-flow">
<h2>Program Execution Flow<a class="headerlink" href="#program-execution-flow" title="Link to this heading">#</a></h2>
<section id="importing-the-libraries-and-input-files">
<h3>Importing the libraries and Input files<a class="headerlink" href="#importing-the-libraries-and-input-files" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Importing the required libraries</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">shutil</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">dask.dataframe</span> <span class="k">as</span> <span class="nn">dd</span>

<span class="n">homedir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">&#39;~&#39;</span><span class="p">)</span>
<span class="n">work_dir</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;../data&quot;</span>

<span class="c1"># Set Pandas options to display all columns</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_columns&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>


<span class="c1"># Define file paths for various CSV files</span>
<span class="n">current_ready_csv_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">work_dir</span><span class="si">}</span><span class="s1">/final_merged_data_3yrs_all_active_stations_v1.csv_sorted.csv&#39;</span>
<span class="n">cleaned_csv_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">current_ready_csv_path</span><span class="si">}</span><span class="s2">_cleaned_nodata.csv&quot;</span>
<span class="n">target_time_series_csv_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">cleaned_csv_path</span><span class="si">}</span><span class="s1">_time_series_v1.csv&#39;</span>
<span class="n">backup_time_series_csv_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">cleaned_csv_path</span><span class="si">}</span><span class="s1">_time_series_v1_bak.csv&#39;</span>
<span class="n">target_time_series_cumulative_csv_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">cleaned_csv_path</span><span class="si">}</span><span class="s1">_time_series_cumulative_v1.csv&#39;</span>
</pre></div>
</div>
</div>
</div>
<p>Initially, it imports necessary libraries such as Pandas, os, shutil, numpy, and Dask.dataframe.</p>
<p><strong>Pandas</strong> is a powerful data manipulation library in Python used for data analysis and manipulation. It provides data structures like DataFrame and Series, which are highly efficient for handling structured data like CSV files</p>
<p>The <strong>shutil</strong> module offers a high-level interface for file operations, including copying, moving, and removing files and directories. It’s used for file manipulation tasks that are more complex than what the os module provides.</p>
<p><strong>NumPy</strong> is a fundamental library for scientific computing in Python. It provides support for large, multi-dimensional arrays and matrices, along with a collection of mathematical functions to operate on these arrays efficiently.</p>
<p><strong>Dask</strong> is a parallel computing library in Python that enables scalable and distributed computing. It extends the capabilities of libraries like Pandas, NumPy, and Scikit-learn to handle datasets that are larger than memory or can benefit from parallel processing. Dask dataframes, similar to Pandas dataframes, allow for efficient manipulation of larger-than-memory datasets by parallelizing operations across multiple cores or machines.</p>
<p>By default, Pandas truncates the display of columns if they exceed a certain number, making it difficult to see the entire dataset when printed. So Pandas options are set to display all columns when printing data frames.</p>
<p>We are importing the file which we have created in the previous chapter by integrating all the data from different sources.</p>
<p>The defined file paths indicate paths for various stages of data processing, such as cleaned data, time-series data, and backup files. Overall, the code sets up file paths and options necessary for handling CSV data effectively.</p>
</section>
<section id="cleaning-and-preparation">
<h3>Cleaning and Preparation<a class="headerlink" href="#cleaning-and-preparation" title="Link to this heading">#</a></h3>
<p>Cleaning the dataset to remove rows with missing SWE values, ensuring that the subsequent analysis is based on complete and accurate data. This step is critical for maintaining the integrity of the analysis, as missing values can significantly skew results and interpretations.</p>
<section id="clean-non-swe-rows">
<h4>clean_non_swe_rows<a class="headerlink" href="#clean-non-swe-rows" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p><strong>Purpose:</strong> Removes rows from the dataset where ‘swe_value’ is missing. This initial cleaning step is crucial for ensuring the dataset’s integrity for further processing and analysis.</p></li>
<li><p><strong>Implementation:</strong> Utilizes Dask for efficient processing of potentially large datasets, ensuring scalability and performance.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">clean_non_swe_rows</span><span class="p">(</span><span class="n">current_ready_csv_path</span><span class="p">,</span> <span class="n">cleaned_csv_path</span><span class="p">):</span>
    <span class="c1"># Read Dask DataFrame from CSV</span>
    <span class="n">dask_df</span> <span class="o">=</span> <span class="n">dd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">current_ready_csv_path</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;stationTriplet&#39;</span><span class="p">:</span> <span class="s1">&#39;object&#39;</span><span class="p">,</span>
       <span class="s1">&#39;station_name&#39;</span><span class="p">:</span> <span class="s1">&#39;object&#39;</span><span class="p">})</span>

    <span class="c1"># Remove rows where &#39;swe_value&#39; is empty</span>
    <span class="n">dask_df_filtered</span> <span class="o">=</span> <span class="n">dask_df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;swe_value&#39;</span><span class="p">])</span>

    <span class="c1"># Save the result to a new CSV file</span>
    <span class="n">dask_df_filtered</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">cleaned_csv_path</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">single_file</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;dask_df_filtered.shape = &quot;</span><span class="p">,</span> <span class="n">dask_df_filtered</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The filtered csv with no swe values is saved to </span><span class="si">{</span><span class="n">cleaned_csv_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">clean_non_swe_rows</span><span class="p">(</span><span class="n">current_ready_csv_path</span><span class="p">,</span> <span class="n">cleaned_csv_path</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dask_df_filtered.shape =  (Delayed(&#39;int-9cb5fc4a-a845-4ea2-935c-087927af926b&#39;), 26)
The filtered csv with no swe values is saved to ../data/final_merged_data_3yrs_all_active_stations_v1.csv_sorted.csv_cleaned_nodata.csv
</pre></div>
</div>
</div>
</div>
<p>In this code snippet we are utilizing Dask to read CSV file and store its data in a Dask DataFrame. Subsequently, it filters out rows containing empty values in the ‘swe_value’ column, creating a new Dask DataFrame (dask_df_filtered). The filtered DataFrame is then saved to a new CSV file (cleaned_csv_path)</p>
</section>
</section>
<section id="interpolation-and-missing-data-handling">
<h3>Interpolation and Missing Data Handling<a class="headerlink" href="#interpolation-and-missing-data-handling" title="Link to this heading">#</a></h3>
<p>With a clean dataset, the script proceeds to interpolate missing values for specified columns. This step is essential for filling gaps in the dataset without introducing significant biases, allowing for a more continuous and comprehensive analysis of temporal trends.</p>
<section id="interpolate-missing-inplace">
<h4>interpolate_missing_inplace<a class="headerlink" href="#interpolate-missing-inplace" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p><strong>Purpose:</strong> Performs in-place interpolation of missing values for specified columns, using a polynomial of a given degree. Custom logic is applied based on the column name to appropriately handle different types of missing data.</p></li>
<li><p><strong>Details:</strong> The function checks for specific conditions (e.g., SWE values above a certain threshold) to decide on the interpolation strategy. It ensures that no null values remain post-interpolation, maintaining the dataset’s completeness.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">interpolate_missing_inplace</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">column_name</span><span class="p">,</span> <span class="n">degree</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">column_name</span><span class="p">]</span>

    <span class="c1"># Create a mask for missing values</span>
    <span class="k">if</span> <span class="n">column_name</span> <span class="o">==</span> <span class="s2">&quot;SWE&quot;</span><span class="p">:</span>
      <span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span> <span class="o">&gt;</span> <span class="mi">240</span><span class="p">)</span> <span class="o">|</span> <span class="n">y</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">column_name</span> <span class="o">==</span> <span class="s2">&quot;fsca&quot;</span><span class="p">:</span>
      <span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">)</span> <span class="o">|</span> <span class="n">y</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">mask</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span>

    <span class="c1"># Check if all elements in the mask array are True</span>
    <span class="n">all_true</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">all_true</span><span class="p">:</span>
      <span class="n">df</span><span class="p">[</span><span class="n">column_name</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="c1"># Perform interpolation</span>
      <span class="n">new_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="o">~</span><span class="n">mask</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="o">~</span><span class="n">mask</span><span class="p">])</span>
      <span class="c1"># Replace missing values with interpolated values</span>
      <span class="n">df</span><span class="p">[</span><span class="n">column_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_y</span>

    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">column_name</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()):</span>
      <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Single group: shouldn&#39;t have null values here&quot;</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">df</span>
</pre></div>
</div>
</div>
</div>
<p>This code snippet processes a DataFrame (df) by interpolating missing values in a specified column (column_name). First, it extracts the indices (x) and values (y) from the DataFrame for the specified column. Then, it creates a mask to identify missing values based on the column name. If the column is “SWE” or “fsca”, values exceeding specific thresholds or being null are marked in the mask. Otherwise, any null values are marked. If all values in the mask are true, indicating all data points are missing, the column is filled with zeros. Otherwise, missing values are interpolated using the numpy interp function. After interpolation, it checks if there are any remaining null values in the column; if so, it raises a ValueError. Finally, it returns the processed DataFrame. Overall, this code ensures that missing values in the specified column are either filled with interpolated values or zeros, depending on the conditions specified.</p>
</section>
</section>
<section id="conversion-to-time-series-format">
<h3>Conversion to Time Series Format<a class="headerlink" href="#conversion-to-time-series-format" title="Link to this heading">#</a></h3>
<p>Following interpolation, the script converts the dataset into a time series format. This transformation is pivotal for temporal analysis, enabling the examination of how SWE and meteorological variables change over time.</p>
<section id="convert-to-time-series">
<h4>convert_to_time_series<a class="headerlink" href="#convert-to-time-series" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p><strong>Purpose:</strong> Transforms the dataset into a time series format, sorting data and filling missing values with interpolated data. This step prepares the dataset for time series analysis, facilitating the examination of temporal patterns and trends.</p></li>
<li><p><strong>Process:</strong> The function reads the cleaned CSV, sorts the data, performs interpolation for missing values, and structures the dataset for time series analysis. It handles specific columns identified for time series conversion, ensuring they are correctly processed and formatted.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">columns_to_be_time_series</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;SWE&quot;</span><span class="p">,</span> 
                                 <span class="s1">&#39;air_temperature_tmmn&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;potential_evapotranspiration&#39;</span><span class="p">,</span> 
                                 <span class="s1">&#39;mean_vapor_pressure_deficit&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;relative_humidity_rmax&#39;</span><span class="p">,</span> 
                                 <span class="s1">&#39;relative_humidity_rmin&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;precipitation_amount&#39;</span><span class="p">,</span> 
                                 <span class="s1">&#39;air_temperature_tmmx&#39;</span><span class="p">,</span> 
                                 <span class="s1">&#39;wind_speed&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;fsca&#39;</span><span class="p">]</span>

<span class="c1"># Read the cleaned ready CSV</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">cleaned_csv_path</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">,</span> <span class="s1">&#39;date&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;All current columns: &quot;</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
    
    <span class="c1"># rename all columns to unified names</span>
    <span class="c1">#     [&#39;date&#39;, &#39;lat&#39;, &#39;lon&#39;, &#39;SWE&#39;, &#39;Flag&#39;, &#39;swe_value&#39;, &#39;cell_id&#39;,</span>
<span class="c1"># &#39;station_id&#39;, &#39;etr&#39;, &#39;pr&#39;, &#39;rmax&#39;, &#39;rmin&#39;, &#39;tmmn&#39;, &#39;tmmx&#39;, &#39;vpd&#39;, &#39;vs&#39;,</span>
<span class="c1"># &#39;elevation&#39;, &#39;slope&#39;, &#39;curvature&#39;, &#39;aspect&#39;, &#39;eastness&#39;, &#39;northness&#39;,</span>
<span class="c1"># &#39;fsca&#39;]</span>
<span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;vpd&#39;</span><span class="p">:</span> <span class="s1">&#39;mean_vapor_pressure_deficit&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;vs&#39;</span><span class="p">:</span> <span class="s1">&#39;wind_speed&#39;</span><span class="p">,</span> 
                        <span class="s1">&#39;pr&#39;</span><span class="p">:</span> <span class="s1">&#39;precipitation_amount&#39;</span><span class="p">,</span> 
                        <span class="s1">&#39;etr&#39;</span><span class="p">:</span> <span class="s1">&#39;potential_evapotranspiration&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;tmmn&#39;</span><span class="p">:</span> <span class="s1">&#39;air_temperature_tmmn&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;tmmx&#39;</span><span class="p">:</span> <span class="s1">&#39;air_temperature_tmmx&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;rmin&#39;</span><span class="p">:</span> <span class="s1">&#39;relative_humidity_rmin&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;rmax&#39;</span><span class="p">:</span> <span class="s1">&#39;relative_humidity_rmax&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;AMSR_SWE&#39;</span><span class="p">:</span> <span class="s1">&#39;SWE&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;fSCA&#39;</span><span class="p">:</span> <span class="s1">&#39;fsca&#39;</span>
                    <span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">filled_csv</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">target_time_series_csv_path</span><span class="si">}</span><span class="s2">_gap_filled.csv&quot;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>All current columns:  Index([&#39;date&#39;, &#39;lat&#39;, &#39;lon&#39;, &#39;AMSR_SWE&#39;, &#39;station_name&#39;, &#39;swe_value&#39;,
       &#39;change_in_swe_inch&#39;, &#39;snow_depth&#39;, &#39;air_temperature_observed_f&#39;,
       &#39;air_temperature_tmmn&#39;, &#39;potential_evapotranspiration&#39;,
       &#39;mean_vapor_pressure_deficit&#39;, &#39;relative_humidity_rmax&#39;,
       &#39;relative_humidity_rmin&#39;, &#39;precipitation_amount&#39;,
       &#39;air_temperature_tmmx&#39;, &#39;wind_speed&#39;, &#39;stationTriplet&#39;, &#39;elevation&#39;,
       &#39;Elevation&#39;, &#39;Slope&#39;, &#39;Aspect&#39;, &#39;Curvature&#39;, &#39;Northness&#39;, &#39;Eastness&#39;,
       &#39;fSCA&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<p>Above code snippet prepares a DataFrame for time series analysis by renaming selected columns to unified names and sorting the DataFrame based on latitude, longitude, and date. Initially, it specifies the columns to be considered as time series data. Then, it reads a cleaned CSV file into a Pandas DataFrame and sorts it based on latitude, longitude, and date. The code prints out all the current column names for reference. Next, it renames specific columns to standard names to ensure consistency across datasets. Finally, it defines a path for the output CSV file after gap filling, which is essential for completing the time series data preparation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">filled_csv</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">filled_csv</span><span class="si">}</span><span class="s2"> already exists, skipping&quot;</span><span class="p">)</span>
        <span class="n">filled_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filled_csv</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="c1"># Function to perform polynomial interpolation and fill in missing values</span>
    <span class="k">def</span> <span class="nf">process_group_filling_value</span><span class="p">(</span><span class="n">group</span><span class="p">):</span>
        <span class="c1"># Sort the group by &#39;date&#39;</span>
        <span class="n">group</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;date&#39;</span><span class="p">)</span>
    
        <span class="k">for</span> <span class="n">column_name</span> <span class="ow">in</span> <span class="n">columns_to_be_time_series</span><span class="p">:</span>
            <span class="n">group</span> <span class="o">=</span> <span class="n">interpolate_missing_inplace</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="n">column_name</span><span class="p">)</span>
        <span class="c1"># Return the processed group</span>
        <span class="k">return</span> <span class="n">group</span>
    <span class="c1"># Group the data by &#39;lat&#39; and &#39;lon&#39; and apply interpolation for each column</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Start to fill in the missing values&quot;</span><span class="p">)</span>
    <span class="n">grouped</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">])</span>
    <span class="n">filled_data</span> <span class="o">=</span> <span class="n">grouped</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">process_group_filling_value</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


    <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">filled_data</span><span class="p">[</span><span class="s1">&#39;fsca&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Error: shouldn&#39;t have SWE&gt;240 at this point&quot;</span><span class="p">)</span>

    <span class="n">filled_data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">filled_csv</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;New filled values csv is saved to </span><span class="si">{</span><span class="n">filled_csv</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Start to fill in the missing values
New filled values csv is saved to ../data/final_merged_data_3yrs_all_active_stations_v1.csv_sorted.csv_cleaned_nodata.csv_time_series_v1.csv_gap_filled.csv
</pre></div>
</div>
</div>
</div>
<p>This code snippet checks if a CSV file named filled_csv exists. If it does, it prints a message indicating that the file exists and reads its contents into a Pandas DataFrame called filled_data. If the file doesn’t exist, the code defines a function named process_group_filling_value to perform polynomial interpolation and fill missing values for each group sorted by date. Then, it groups the data by latitude and longitude, applies the interpolation function to fill missing values for each column specified in columns_to_be_time_series, and resets the index. After interpolation, it checks if any values in the ‘fsca’ column exceed 100; if so, it raises a ValueError. Finally, the filled DataFrame is saved to the CSV file filled_csv, and a message confirms the completion of the process.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">target_time_series_csv_path</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">target_time_series_csv_path</span><span class="si">}</span><span class="s2"> already exists, skipping&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">filled_data</span>
    <span class="c1"># Create a new DataFrame to store the time series data for each location</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Start to create the training csv with previous 7 days columns&quot;</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

    <span class="c1"># Define the number of days to consider (7 days in this case)</span>
    <span class="n">num_days</span> <span class="o">=</span> <span class="mi">7</span>

    <span class="n">grouped</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">])</span>
    
    <span class="k">def</span> <span class="nf">process_group_time_series</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="n">num_days</span><span class="p">):</span>
        <span class="n">group</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;date&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">day</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_days</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">target_col</span> <span class="ow">in</span> <span class="n">columns_to_be_time_series</span><span class="p">:</span>
                <span class="n">new_column_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">target_col</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">day</span><span class="si">}</span><span class="s1">&#39;</span>
                <span class="n">group</span><span class="p">[</span><span class="n">new_column_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">group</span><span class="p">[</span><span class="n">target_col</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">day</span><span class="p">)</span>
            
        <span class="k">return</span> <span class="n">group</span>
    
    <span class="n">result</span> <span class="o">=</span> <span class="n">grouped</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">group</span><span class="p">:</span> <span class="n">process_group_time_series</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="n">num_days</span><span class="p">))</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">result</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="n">result</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">target_time_series_csv_path</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;New data is saved to </span><span class="si">{</span><span class="n">target_time_series_csv_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">target_time_series_csv_path</span><span class="p">,</span> <span class="n">backup_time_series_csv_path</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File is backed up to </span><span class="si">{</span><span class="n">backup_time_series_csv_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Start to create the training csv with previous 7 days columns
New data is saved to ../data/final_merged_data_3yrs_all_active_stations_v1.csv_sorted.csv_cleaned_nodata.csv_time_series_v1.csv
File is backed up to ../data/final_merged_data_3yrs_all_active_stations_v1.csv_sorted.csv_cleaned_nodata.csv_time_series_v1_bak.csv
</pre></div>
</div>
</div>
</div>
<p>First checks if a CSV file named target_time_series_csv_path exists. If it does, it prints a message indicating that the file exists and skips further processing. If the file doesn’t exist, it assigns the DataFrame filled_data to df and proceeds to create a new DataFrame named result to store time series data for each location. The code initializes the num_days variable to 7 and groups the data by latitude and longitude. It defines a function process_group_time_series to create columns for each target column shifted by the previous 7 days. These columns are then filled with corresponding values or zeros if no data is available. The result is saved to a CSV file target_time_series_csv_path, and a message confirms the completion of the process. Additionally, the newly created CSV file is backed up to backup_time_series_csv_path. In summary, this code generates a time series dataset by shifting data for specified columns over the previous 7 days and saves it to a CSV file, along with creating a backup copy of the file.</p>
</section>
</section>
<section id="addition-of-cumulative-columns">
<h3>Addition of Cumulative Columns<a class="headerlink" href="#addition-of-cumulative-columns" title="Link to this heading">#</a></h3>
<p>To enrich the dataset further, the script adds cumulative columns for specific variables. This enhancement allows for the analysis of cumulative trends over time, providing additional insights into the accumulation and change of SWE and meteorological variables.</p>
<section id="add-cumulative-columns">
<h4>add_cumulative_columns<a class="headerlink" href="#add-cumulative-columns" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p><strong>Purpose:</strong> Calculates and adds cumulative values for specified variables to the dataset. This step enhances the dataset with cumulative information, facilitating more nuanced analyses of temporal trends and accumulations.</p></li>
<li><p><strong>Details:</strong> The function reads the time series formatted dataset and computes cumulative values for each specified variable, saving the enhanced dataset for further analysis.</p></li>
</ul>
</section>
</section>
<section id="execution-and-output">
<h3>Execution and Output<a class="headerlink" href="#execution-and-output" title="Link to this heading">#</a></h3>
<p>The script executes the defined functions in a structured sequence, starting from data cleaning, followed by interpolation, conversion to time series format, and finally, the addition of cumulative columns. The output is a thoroughly processed dataset ready for comprehensive time series analysis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">add_cumulative_columns</span><span class="p">(</span><span class="n">input_csv</span><span class="p">,</span> <span class="n">output_csv</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add cumulative columns to the time series dataset.</span>

<span class="sd">    This function reads the time series CSV file created by `convert_to_time_series`, calculates cumulative values for specific columns, and saves the data to a new CSV file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">columns_to_be_cumulated</span> <span class="o">=</span> <span class="p">[</span>
      <span class="s2">&quot;SWE&quot;</span><span class="p">,</span>
      <span class="s1">&#39;air_temperature_tmmn&#39;</span><span class="p">,</span>
      <span class="s1">&#39;potential_evapotranspiration&#39;</span><span class="p">,</span> 
      <span class="s1">&#39;mean_vapor_pressure_deficit&#39;</span><span class="p">,</span>
      <span class="s1">&#39;relative_humidity_rmax&#39;</span><span class="p">,</span> 
      <span class="s1">&#39;relative_humidity_rmin&#39;</span><span class="p">,</span>
      <span class="s1">&#39;precipitation_amount&#39;</span><span class="p">,</span> 
      <span class="s1">&#39;air_temperature_tmmx&#39;</span><span class="p">,</span> 
      <span class="s1">&#39;wind_speed&#39;</span><span class="p">,</span>
      <span class="s1">&#39;fsca&#39;</span>
    <span class="p">]</span>

    <span class="c1"># Read the time series CSV (ensure it was created using `convert_to_time_series` function)</span>
    <span class="c1"># directly read from original file</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">input_csv</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;the column statistics from time series before cumulative: &quot;</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
    
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">])</span>
    
    <span class="n">unique_years</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;This is our unique years&quot;</span><span class="p">,</span> <span class="n">unique_years</span><span class="p">)</span>
    <span class="c1">#current_df[&#39;fSCA&#39;] = current_df[&#39;fSCA&#39;].fillna(0)</span>
    
    <span class="c1"># only start from the water year 10-01</span>
    <span class="c1"># Filter rows based on the date range (2019 to 2022)</span>
    <span class="n">start_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="s1">&#39;2018-10-01&#39;</span><span class="p">)</span>
    <span class="n">end_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="s1">&#39;2021-09-30&#39;</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">start_date</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">end_date</span><span class="p">)]</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;how many rows are left in the three water years?&quot;</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
    <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">current_ready_csv_path</span><span class="si">}</span><span class="s2">.test_check.csv&quot;</span><span class="p">)</span>

    <span class="c1"># Define a function to calculate the water year</span>
    <span class="k">def</span> <span class="nf">calculate_water_year</span><span class="p">(</span><span class="n">date</span><span class="p">):</span>
        <span class="n">year</span> <span class="o">=</span> <span class="n">date</span><span class="o">.</span><span class="n">year</span>
        <span class="k">if</span> <span class="n">date</span><span class="o">.</span><span class="n">month</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">:</span>  <span class="c1"># Water year starts in October</span>
            <span class="k">return</span> <span class="n">year</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">year</span>
    
    <span class="c1"># every water year starts at Oct 1, and ends at Sep 30. </span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;water_year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">calculate_water_year</span><span class="p">)</span>
    
    <span class="c1"># Group the DataFrame by &#39;lat&#39; and &#39;lon&#39;</span>
    <span class="n">grouped</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">,</span> <span class="s1">&#39;water_year&#39;</span><span class="p">],</span> <span class="n">group_keys</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;how many groups? &quot;</span><span class="p">,</span> <span class="n">grouped</span><span class="p">)</span>
    
    <span class="c1"># grouped = df.groupby([&#39;lat&#39;, &#39;lon&#39;, &#39;water_year&#39;], group_keys=False)</span>
    <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">columns_to_be_cumulated</span><span class="p">:</span>
        <span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;cumulative_</span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">grouped</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">group</span><span class="p">:</span> <span class="n">group</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;date&#39;</span><span class="p">)[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">cumsum</span><span class="p">())</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;This is the dataframe after cumulative columns are added&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;cumulative_fsca&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
    
    <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">output_csv</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;All the cumulative variables are added successfully! </span><span class="si">{</span><span class="n">target_time_series_cumulative_csv_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;double check the swe_value statistics:&quot;</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;swe_value&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>

<span class="n">add_cumulative_columns</span><span class="p">(</span><span class="n">target_time_series_csv_path</span><span class="p">,</span> <span class="n">target_time_series_cumulative_csv_path</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>the column statistics from time series before cumulative:                  lat           lon           SWE     swe_value  \
count  11403.000000  11403.000000  11403.000000  11403.000000   
mean      42.033890   -118.197574      0.910795      7.720705   
std        3.657384      3.830467      5.044520     12.473113   
min       37.522170   -122.165180      0.000000      0.000000   
25%       37.724000   -121.698470      0.000000      0.000000   
50%       41.235830   -120.215000      0.000000      0.800000   
75%       45.597230   -112.271180      0.000000     11.600000   
max       47.779570   -111.959020     31.000000     74.600000   

       change_in_swe_inch    snow_depth  air_temperature_observed_f  \
count        11403.000000  11403.000000                11403.000000   
mean             0.011839     15.950715                   27.149066   
std              1.671899     27.443505                   19.488291   
min            -12.000000      0.000000                  -15.000000   
25%              0.000000      0.000000                    0.000000   
50%              0.000000      0.000000                   31.100000   
75%              0.000000     23.500000                   41.900000   
max             24.000000    152.000000                   80.100000   

       air_temperature_tmmn  potential_evapotranspiration  \
count          11403.000000                  11403.000000   
mean             268.364807                      2.393150   
std                6.400441                      2.031224   
min              242.800000                      0.100000   
25%              263.200000                      1.100000   
50%              266.500000                      2.100000   
75%              270.800000                      3.100000   
max              291.300000                     13.200000   

       mean_vapor_pressure_deficit  relative_humidity_rmax  \
count                 11403.000000            11403.000000   
mean                      0.325473               89.362986   
std                       0.362265               16.888436   
min                       0.000000               19.300001   
25%                       0.140000               86.400000   
50%                       0.160000              100.000000   
75%                       0.360000              100.000000   
max                       2.460000              100.000000   

       relative_humidity_rmin  precipitation_amount  air_temperature_tmmx  \
count            11403.000000          11403.000000          11403.000000   
mean                47.262329              1.984547            277.065900   
std                 16.413106              6.971380              7.297879   
min                  1.900000              0.000000            258.000000   
25%                 34.600002              0.000000            273.900000   
50%                 47.900000              0.000000            275.700000   
75%                 61.750000              2.000000            278.800000   
max                100.000000             96.600000            304.200000   

         wind_speed     elevation     Elevation         Slope        Aspect  \
count  11403.000000  11403.000000  11403.000000  11403.000000  11403.000000   
mean       3.816248   7158.930106   2132.513611      0.479588    156.641746   
std        1.578395   1802.714605    765.494212      0.213980     93.392659   
min        0.900000   3500.000000    505.759100      0.230049     48.422430   
25%        2.600000   6010.000000   1864.849100      0.326385     55.572987   
50%        3.300000   7600.000000   2009.396400      0.442039    144.240680   
75%        4.500000   8900.000000   2389.243200      0.714844    198.053850   
max       15.500000   9450.000000   3336.792500      0.793381    344.568820   

          Curvature     Northness      Eastness     fsca         SWE_1  \
count  11403.000000  11403.000000  11403.000000  11403.0  11403.000000   
mean   -4570.677704     -0.096578     -0.203612      0.0      0.908076   
std     3190.986998      0.648622      0.468931      0.0      5.036650   
min   -11866.799000     -0.774647     -0.771576      0.0      0.000000   
25%    -5300.959500     -0.760165     -0.689709      0.0      0.000000   
50%    -4466.613000      0.227904     -0.528856      0.0      0.000000   
75%    -2247.001200      0.585900      0.260055      0.0      0.000000   
max      426.612670      0.767045      0.323832      0.0     31.000000   

       air_temperature_tmmn_1  potential_evapotranspiration_1  \
count            11403.000000                    11403.000000   
mean               268.178259                        2.392018   
std                  9.562912                        2.031923   
min                  0.000000                        0.000000   
25%                263.200000                        1.100000   
50%                266.500000                        2.100000   
75%                270.800000                        3.100000   
max                291.300000                       13.200000   

       mean_vapor_pressure_deficit_1  relative_humidity_rmax_1  \
count                   11403.000000              11403.000000   
mean                        0.325365                 89.294311   
std                         0.362332                 17.051468   
min                         0.000000                  0.000000   
25%                         0.140000                 86.400000   
50%                         0.160000                100.000000   
75%                         0.360000                100.000000   
max                         2.460000                100.000000   

       relative_humidity_rmin_1  precipitation_amount_1  \
count              11403.000000            11403.000000   
mean                  47.222997                1.980329   
std                   16.454236                6.960445   
min                    0.000000                0.000000   
25%                   34.600002                0.000000   
50%                   47.900000                0.000000   
75%                   61.650001                2.000000   
max                  100.000000               96.600000   

       air_temperature_tmmx_1  wind_speed_1   fsca_1         SWE_2  \
count            11403.000000  11403.000000  11403.0  11403.000000   
mean               276.874494      3.813152      0.0      0.905358   
std                 10.346836      1.580513      0.0      5.028767   
min                  0.000000      0.000000      0.0      0.000000   
25%                273.900000      2.600000      0.0      0.000000   
50%                275.700000      3.300000      0.0      0.000000   
75%                278.800000      4.500000      0.0      0.000000   
max                304.200000     15.500000      0.0     31.000000   

       air_temperature_tmmn_2  potential_evapotranspiration_2  \
count            11403.000000                    11403.000000   
mean               267.991712                        2.390887   
std                 11.910639                        2.032621   
min                  0.000000                        0.000000   
25%                263.200000                        1.100000   
50%                266.500000                        2.100000   
75%                270.800000                        3.100000   
max                291.300000                       13.200000   

       mean_vapor_pressure_deficit_2  relative_humidity_rmax_2  \
count                   11403.000000              11403.000000   
mean                        0.325256                 89.225636   
std                         0.362398                 17.212682   
min                         0.000000                  0.000000   
25%                         0.140000                 86.400000   
50%                         0.160000                100.000000   
75%                         0.360000                100.000000   
max                         2.460000                100.000000   

       relative_humidity_rmin_2  precipitation_amount_2  \
count              11403.000000            11403.000000   
mean                  47.183665                1.976111   
std                   16.495168                6.949491   
min                    0.000000                0.000000   
25%                   34.600002                0.000000   
50%                   47.900000                0.000000   
75%                   61.450000                2.000000   
max                  100.000000               96.600000   

       air_temperature_tmmx_2  wind_speed_2   fsca_2         SWE_3  \
count            11403.000000  11403.000000  11403.0  11403.000000   
mean               276.683089      3.810057      0.0      0.902639   
std                 12.679972      1.582622      0.0      5.020869   
min                  0.000000      0.000000      0.0      0.000000   
25%                273.900000      2.600000      0.0      0.000000   
50%                275.700000      3.300000      0.0      0.000000   
75%                278.800000      4.500000      0.0      0.000000   
max                304.200000     15.500000      0.0     31.000000   

       air_temperature_tmmn_3  potential_evapotranspiration_3  \
count            11403.000000                    11403.000000   
mean               267.805164                        2.389756   
std                 13.863901                        2.033318   
min                  0.000000                        0.000000   
25%                263.200000                        1.100000   
50%                266.500000                        2.100000   
75%                270.800000                        3.100000   
max                291.300000                       13.200000   

       mean_vapor_pressure_deficit_3  relative_humidity_rmax_3  \
count                   11403.000000              11403.000000   
mean                        0.325147                 89.156962   
std                         0.362465                 17.372129   
min                         0.000000                  0.000000   
25%                         0.140000                 86.400000   
50%                         0.160000                100.000000   
75%                         0.360000                100.000000   
max                         2.460000                100.000000   

       relative_humidity_rmin_3  precipitation_amount_3  \
count              11403.000000            11403.000000   
mean                  47.144334                1.971892   
std                   16.535906                6.938516   
min                    0.000000                0.000000   
25%                   34.600002                0.000000   
50%                   47.900000                0.000000   
75%                   61.400000                2.000000   
max                  100.000000               96.600000   

       air_temperature_tmmx_3  wind_speed_3   fsca_3         SWE_4  \
count            11403.000000  11403.000000  11403.0  11403.000000   
mean               276.491683      3.806961      0.0      0.899920   
std                 14.643535      1.584723      0.0      5.012958   
min                  0.000000      0.000000      0.0      0.000000   
25%                273.900000      2.600000      0.0      0.000000   
50%                275.700000      3.300000      0.0      0.000000   
75%                278.800000      4.500000      0.0      0.000000   
max                304.200000     15.500000      0.0     31.000000   

       air_temperature_tmmn_4  potential_evapotranspiration_4  \
count            11403.000000                    11403.000000   
mean               267.618617                        2.388624   
std                 15.571852                        2.034015   
min                  0.000000                        0.000000   
25%                263.200000                        1.100000   
50%                266.500000                        2.100000   
75%                270.800000                        3.100000   
max                291.300000                       13.200000   

       mean_vapor_pressure_deficit_4  relative_humidity_rmax_4  \
count                   11403.000000              11403.000000   
mean                        0.325038                 89.088287   
std                         0.362532                 17.529857   
min                         0.000000                  0.000000   
25%                         0.140000                 86.400000   
50%                         0.160000                100.000000   
75%                         0.360000                100.000000   
max                         2.460000                100.000000   

       relative_humidity_rmin_4  precipitation_amount_4  \
count              11403.000000            11403.000000   
mean                  47.105002                1.967674   
std                   16.576451                6.927522   
min                    0.000000                0.000000   
25%                   34.600002                0.000000   
50%                   47.900000                0.000000   
75%                   61.281818                2.000000   
max                  100.000000               96.600000   

       air_temperature_tmmx_4  wind_speed_4   fsca_4         SWE_5  \
count            11403.000000  11403.000000  11403.0  11403.000000   
mean               276.300277      3.803865      0.0      0.897202   
std                 16.371049      1.586814      0.0      5.005032   
min                  0.000000      0.000000      0.0      0.000000   
25%                273.900000      2.600000      0.0      0.000000   
50%                275.700000      3.300000      0.0      0.000000   
75%                278.800000      4.500000      0.0      0.000000   
max                304.200000     15.500000      0.0     31.000000   

       air_temperature_tmmn_5  potential_evapotranspiration_5  \
count             11403.00000                    11403.000000   
mean                267.43207                        2.387493   
std                  17.10812                        2.034710   
min                   0.00000                        0.000000   
25%                 263.20000                        1.100000   
50%                 266.50000                        2.100000   
75%                 270.80000                        3.100000   
max                 291.30000                       13.200000   

       mean_vapor_pressure_deficit_5  relative_humidity_rmax_5  \
count                   11403.000000              11403.000000   
mean                        0.324930                 89.019612   
std                         0.362598                 17.685911   
min                         0.000000                  0.000000   
25%                         0.140000                 86.400000   
50%                         0.160000                100.000000   
75%                         0.360000                100.000000   
max                         2.460000                100.000000   

       relative_humidity_rmin_5  precipitation_amount_5  \
count              11403.000000            11403.000000   
mean                  47.065670                1.963456   
std                   16.616803                6.916507   
min                    0.000000                0.000000   
25%                   34.600002                0.000000   
50%                   47.900000                0.000000   
75%                   61.100002                2.000000   
max                  100.000000               96.600000   

       air_temperature_tmmx_5  wind_speed_5   fsca_5         SWE_6  \
count            11403.000000  11403.000000  11403.0  11403.000000   
mean               276.108871      3.800770      0.0      0.894483   
std                 17.930870      1.588897      0.0      4.997093   
min                  0.000000      0.000000      0.0      0.000000   
25%                273.900000      2.600000      0.0      0.000000   
50%                275.700000      3.300000      0.0      0.000000   
75%                278.800000      4.500000      0.0      0.000000   
max                304.200000     15.500000      0.0     31.000000   

       air_temperature_tmmn_6  potential_evapotranspiration_6  \
count            11403.000000                    11403.000000   
mean               267.245522                        2.386362   
std                 18.515490                        2.035405   
min                  0.000000                        0.000000   
25%                263.200000                        1.100000   
50%                266.500000                        2.100000   
75%                270.800000                        3.100000   
max                291.300000                       13.200000   

       mean_vapor_pressure_deficit_6  relative_humidity_rmax_6  \
count                   11403.000000              11403.000000   
mean                        0.324821                 88.950937   
std                         0.362665                 17.840335   
min                         0.000000                  0.000000   
25%                         0.140000                 86.400000   
50%                         0.160000                100.000000   
75%                         0.360000                100.000000   
max                         2.460000                100.000000   

       relative_humidity_rmin_6  precipitation_amount_6  \
count              11403.000000            11403.000000   
mean                  47.026338                1.959238   
std                   16.656965                6.905472   
min                    0.000000                0.000000   
25%                   34.600002                0.000000   
50%                   47.900000                0.000000   
75%                   61.100002                2.000000   
max                  100.000000               96.600000   

       air_temperature_tmmx_6  wind_speed_6   fsca_6         SWE_7  \
count            11403.000000  11403.000000  11403.0  11403.000000   
mean               275.917465      3.797674      0.0      0.891765   
std                 19.363566      1.590971      0.0      4.989139   
min                  0.000000      0.000000      0.0      0.000000   
25%                273.900000      2.600000      0.0      0.000000   
50%                275.700000      3.300000      0.0      0.000000   
75%                278.800000      4.500000      0.0      0.000000   
max                304.200000     15.500000      0.0     31.000000   

       air_temperature_tmmn_7  potential_evapotranspiration_7  \
count            11403.000000                    11403.000000   
mean               267.058975                        2.385231   
std                 19.821438                        2.036098   
min                  0.000000                        0.000000   
25%                263.200000                        1.100000   
50%                266.500000                        2.100000   
75%                270.800000                        3.100000   
max                291.300000                       13.200000   

       mean_vapor_pressure_deficit_7  relative_humidity_rmax_7  \
count                   11403.000000              11403.000000   
mean                        0.324712                 88.882262   
std                         0.362731                 17.993173   
min                         0.000000                  0.000000   
25%                         0.140000                 86.400000   
50%                         0.160000                100.000000   
75%                         0.360000                100.000000   
max                         2.460000                100.000000   

       relative_humidity_rmin_7  precipitation_amount_7  \
count              11403.000000            11403.000000   
mean                  46.987007                1.955020   
std                   16.696937                6.894417   
min                    0.000000                0.000000   
25%                   34.600002                0.000000   
50%                   47.900000                0.000000   
75%                   61.000000                2.000000   
max                  100.000000               96.600000   

       air_temperature_tmmx_7  wind_speed_7   fsca_7  
count            11403.000000  11403.000000  11403.0  
mean               275.726060      3.794578      0.0  
std                 20.695555      1.593036      0.0  
min                  0.000000      0.000000      0.0  
25%                273.900000      2.600000      0.0  
50%                275.700000      3.300000      0.0  
75%                278.800000      4.500000      0.0  
max                304.200000     15.500000      0.0  
This is our unique years [2018 2019 2020 2021]
how many rows are left in the three water years?                                 date          lat          lon          SWE  \
count                           7763  7763.000000  7763.000000  7763.000000   
mean   2020-03-04 14:22:33.188200448    42.411904  -118.117059     0.974468   
min              2018-10-01 00:00:00    37.522170  -122.165180     0.000000   
25%              2019-06-01 00:00:00    38.805000  -121.698470     0.000000   
50%              2020-02-27 00:00:00    42.870070  -120.215000     0.000000   
75%              2020-11-25 00:00:00    45.597230  -112.271180     0.000000   
max              2021-09-30 00:00:00    47.779570  -111.959020    31.000000   
std                              NaN     3.573869     4.008733     5.136447   

         swe_value  change_in_swe_inch   snow_depth  \
count  7763.000000         7763.000000  7763.000000   
mean      7.886990            0.001803    17.603761   
min       0.000000          -12.000000     0.000000   
25%       0.000000            0.000000     0.000000   
50%       0.800000            0.000000     0.000000   
75%      11.900000            0.000000    27.000000   
max      74.600000           19.000000   148.000000   
std      12.707772            1.684385    27.903760   

       air_temperature_observed_f  air_temperature_tmmn  \
count                 7763.000000           7763.000000   
mean                    29.467319            266.294098   
min                    -12.100000            252.400000   
25%                     17.600000            263.200000   
50%                     32.400000            265.600000   
75%                     43.000000            270.300000   
max                     80.100000            283.600000   
std                     18.549883              4.105884   

       potential_evapotranspiration  mean_vapor_pressure_deficit  \
count                   7763.000000                   7763.00000   
mean                       1.788988                      0.19692   
min                        0.100000                      0.00000   
25%                        1.100000                      0.14000   
50%                        1.300000                      0.15000   
75%                        2.300000                      0.17000   
max                        9.900001                      1.34000   
std                        1.392821                      0.14182   

       relative_humidity_rmax  relative_humidity_rmin  precipitation_amount  \
count             7763.000000             7763.000000           7763.000000   
mean                94.393900               51.202310              1.654234   
min                 19.300001                1.900000              0.000000   
25%                 96.700005               44.900000              0.000000   
50%                100.000000               51.400000              0.000000   
75%                100.000000               63.200000              2.000000   
max                100.000000              100.000000             72.800000   
std                 12.948656               13.686066              6.205829   

       air_temperature_tmmx   wind_speed    elevation    Elevation  \
count           7763.000000  7763.000000  7763.000000  7763.000000   
mean             274.662851     3.752204  6942.301945  2014.870892   
min              259.600000     1.000000  3500.000000   505.759100   
25%              270.700000     2.600000  6010.000000  1864.849100   
50%              274.900000     3.300000  7400.000000  2009.396400   
75%              276.000000     4.500000  8300.000000  2389.243200   
max              294.100000    12.600000  9450.000000  3336.792500   
std                4.401835     1.408849  1743.899270   702.144077   

             Slope       Aspect     Curvature    Northness     Eastness  \
count  7763.000000  7763.000000   7763.000000  7763.000000  7763.000000   
mean      0.460115   165.762097  -4491.320820    -0.148535    -0.162329   
min       0.230049    48.422430 -11866.799000    -0.774647    -0.771576   
25%       0.326385    76.589060  -5300.959500    -0.760165    -0.642257   
50%       0.340286   191.839920  -4466.613000    -0.681701     0.202369   
75%       0.714844   198.053850  -2247.001200     0.585900     0.260055   
max       0.793381   344.568820    426.612670     0.767045     0.323832   
std       0.211265    92.490507   3282.774001     0.649873     0.464962   

         fsca        SWE_1  air_temperature_tmmn_1  \
count  7763.0  7763.000000             7763.000000   
mean      0.0     0.970474              266.305569   
min       0.0     0.000000              252.400000   
25%       0.0     0.000000              263.200000   
50%       0.0     0.000000              265.600000   
75%       0.0     0.000000              270.300000   
max       0.0    31.000000              283.600000   
std       0.0     5.125138                4.120963   

       potential_evapotranspiration_1  mean_vapor_pressure_deficit_1  \
count                     7763.000000                    7763.000000   
mean                         1.794044                       0.197298   
min                          0.100000                       0.000000   
25%                          1.100000                       0.140000   
50%                          1.300000                       0.150000   
75%                          2.300000                       0.170000   
max                          9.900001                       1.340000   
std                          1.400976                       0.142572   

       relative_humidity_rmax_1  relative_humidity_rmin_1  \
count               7763.000000               7763.000000   
mean                  94.377470                 51.190824   
min                   19.300001                  1.900000   
25%                   96.700005                 44.900000   
50%                  100.000000                 51.400000   
75%                  100.000000                 63.200000   
max                  100.000000                100.000000   
std                   12.964332                 13.692398   

       precipitation_amount_1  air_temperature_tmmx_1  wind_speed_1  fsca_1  \
count             7763.000000             7763.000000   7763.000000  7763.0   
mean                 1.649595              274.667059      3.751716     0.0   
min                  0.000000              259.600000      1.000000     0.0   
25%                  0.000000              270.700000      2.600000     0.0   
50%                  0.000000              274.900000      3.300000     0.0   
75%                  2.000000              276.000000      4.500000     0.0   
max                 72.800000              294.100000     12.600000     0.0   
std                  6.187975                4.402953      1.409127     0.0   

             SWE_2  air_temperature_tmmn_2  potential_evapotranspiration_2  \
count  7763.000000             7763.000000                     7763.000000   
mean      0.966481              266.317923                        1.798063   
min       0.000000              252.400000                        0.100000   
25%       0.000000              263.200000                        1.100000   
50%       0.000000              265.600000                        1.400000   
75%       0.000000              270.300000                        2.300000   
max      31.000000              283.600000                        9.900001   
std       5.113802                4.138059                        1.406309   

       mean_vapor_pressure_deficit_2  relative_humidity_rmax_2  \
count                    7763.000000               7763.000000   
mean                        0.197895                 94.368388   
min                         0.000000                 19.300001   
25%                         0.140000                 96.700005   
50%                         0.150000                100.000000   
75%                         0.170000                100.000000   
max                         1.340000                100.000000   
std                         0.143883                 12.974343   

       relative_humidity_rmin_2  precipitation_amount_2  \
count               7763.000000             7763.000000   
mean                  51.168611                1.643757   
min                    1.900000                0.000000   
25%                   44.900000                0.000000   
50%                   51.400000                0.000000   
75%                   63.200000                2.000000   
max                  100.000000               72.800000   
std                   13.707377                6.169483   

       air_temperature_tmmx_2  wind_speed_2  fsca_2        SWE_3  \
count             7763.000000   7763.000000  7763.0  7763.000000   
mean               274.670040      3.751835     0.0     0.962488   
min                259.600000      1.000000     0.0     0.000000   
25%                270.700000      2.600000     0.0     0.000000   
50%                274.900000      3.300000     0.0     0.000000   
75%                276.000000      4.500000     0.0     0.000000   
max                294.100000     12.600000     0.0    31.000000   
std                  4.403278      1.409173     0.0     5.102437   

       air_temperature_tmmn_3  potential_evapotranspiration_3  \
count             7763.000000                     7763.000000   
mean               266.332453                        1.802082   
min                252.400000                        0.100000   
25%                263.200000                        1.100000   
50%                265.600000                        1.400000   
75%                270.300000                        2.300000   
max                285.600000                        9.900001   
std                  4.162754                        1.411226   

       mean_vapor_pressure_deficit_3  relative_humidity_rmax_3  \
count                    7763.000000               7763.000000   
mean                        0.198984                 94.360865   
min                         0.000000                 19.300001   
25%                         0.140000                 96.700005   
50%                         0.150000                100.000000   
75%                         0.170000                100.000000   
max                         1.770000                100.000000   
std                         0.148356                 12.982028   

       relative_humidity_rmin_3  precipitation_amount_3  \
count               7763.000000             7763.000000   
mean                  51.131589                1.637561   
min                    1.900000                0.000000   
25%                   44.900000                0.000000   
50%                   51.400000                0.000000   
75%                   63.200000                2.000000   
max                  100.000000               72.800000   
std                   13.741780                6.150975   

       air_temperature_tmmx_3  wind_speed_3  fsca_3        SWE_4  \
count             7763.000000   7763.000000  7763.0  7763.000000   
mean               274.675592      3.750753     0.0     0.958494   
min                259.600000      1.000000     0.0     0.000000   
25%                270.700000      2.600000     0.0     0.000000   
50%                274.900000      3.300000     0.0     0.000000   
75%                276.000000      4.500000     0.0     0.000000   
max                294.100000     12.600000     0.0    31.000000   
std                  4.406498      1.408310     0.0     5.091044   

       air_temperature_tmmn_4  potential_evapotranspiration_4  \
count             7763.000000                     7763.000000   
mean               266.347035                        1.806423   
min                252.400000                        0.100000   
25%                263.200000                        1.100000   
50%                265.600000                        1.400000   
75%                270.300000                        2.300000   
max                286.900000                        9.900001   
std                  4.186795                        1.417122   

       mean_vapor_pressure_deficit_4  relative_humidity_rmax_4  \
count                    7763.000000               7763.000000   
mean                        0.200250                 94.346026   
min                         0.000000                 19.300001   
25%                         0.140000                 96.700005   
50%                         0.150000                100.000000   
75%                         0.170000                100.000000   
max                         2.060000                100.000000   
std                         0.154102                 12.993405   

       relative_humidity_rmin_4  precipitation_amount_4  \
count               7763.000000             7763.000000   
mean                  51.089105                1.631365   
min                    1.900000                0.000000   
25%                   44.900000                0.000000   
50%                   51.400000                0.000000   
75%                   63.200000                2.000000   
max                  100.000000               72.800000   
std                   13.786098                6.132405   

       air_temperature_tmmx_4  wind_speed_4  fsca_4        SWE_5  \
count             7763.000000   7763.000000  7763.0  7763.000000   
mean               274.687907      3.749671     0.0     0.954501   
min                259.600000      1.000000     0.0     0.000000   
25%                270.700000      2.600000     0.0     0.000000   
50%                274.900000      3.300000     0.0     0.000000   
75%                276.000000      4.500000     0.0     0.000000   
max                294.200000     12.600000     0.0    31.000000   
std                  4.420039      1.407245     0.0     5.079622   

       air_temperature_tmmn_5  potential_evapotranspiration_5  \
count             7763.000000                     7763.000000   
mean               266.359733                        1.810558   
min                252.400000                        0.100000   
25%                263.200000                        1.100000   
50%                265.600000                        1.500000   
75%                270.300000                        2.300000   
max                286.900000                        9.900001   
std                  4.204642                        1.422751   

       mean_vapor_pressure_deficit_5  relative_humidity_rmax_5  \
count                    7763.000000               7763.000000   
mean                        0.201348                 94.326022   
min                         0.000000                 19.300001   
25%                         0.140000                 96.700005   
50%                         0.150000                100.000000   
75%                         0.170000                100.000000   
max                         2.060000                100.000000   
std                         0.158275                 13.006813   

       relative_humidity_rmin_5  precipitation_amount_5  \
count               7763.000000             7763.000000   
mean                  51.048016                1.625169   
min                    1.900000                0.000000   
25%                   44.900000                0.000000   
50%                   51.400000                0.000000   
75%                   63.200000                2.000000   
max                  100.000000               72.800000   
std                   13.826982                6.113773   

       air_temperature_tmmx_5  wind_speed_5  fsca_5        SWE_6  \
count             7763.000000   7763.000000  7763.0  7763.000000   
mean               274.703919      3.748689     0.0     0.950508   
min                259.600000      1.000000     0.0     0.000000   
25%                270.700000      2.600000     0.0     0.000000   
50%                274.900000      3.300000     0.0     0.000000   
75%                276.000000      4.500000     0.0     0.000000   
max                296.700000     12.600000     0.0    31.000000   
std                  4.444914      1.406461     0.0     5.068171   

       air_temperature_tmmn_6  potential_evapotranspiration_6  \
count             7763.000000                     7763.000000   
mean               266.370541                        1.814616   
min                252.400000                        0.100000   
25%                263.200000                        1.100000   
50%                265.600000                        1.500000   
75%                270.300000                        2.300000   
max                286.900000                        9.900001   
std                  4.218077                        1.427830   

       mean_vapor_pressure_deficit_6  relative_humidity_rmax_6  \
count                    7763.000000               7763.000000   
mean                        0.202204                 94.295248   
min                         0.000000                 19.300001   
25%                         0.140000                 96.700005   
50%                         0.150000                100.000000   
75%                         0.170000                100.000000   
max                         2.060000                100.000000   
std                         0.160830                 13.035327   

       relative_humidity_rmin_6  precipitation_amount_6  \
count               7763.000000             7763.000000   
mean                  51.012192                1.618973   
min                    1.900000                0.000000   
25%                   44.900000                0.000000   
50%                   51.400000                0.000000   
75%                   63.200000                2.000000   
max                  100.000000               72.800000   
std                   13.856122                6.095078   

       air_temperature_tmmx_6  wind_speed_6  fsca_6        SWE_7  \
count             7763.000000   7763.000000  7763.0  7763.000000   
mean               274.719467      3.748096     0.0     0.946515   
min                259.600000      1.000000     0.0     0.000000   
25%                270.700000      2.600000     0.0     0.000000   
50%                274.900000      3.300000     0.0     0.000000   
75%                276.000000      4.500000     0.0     0.000000   
max                296.700000     12.600000     0.0    31.000000   
std                  4.468404      1.405483     0.0     5.056692   

       air_temperature_tmmn_7  potential_evapotranspiration_7  \
count             7763.000000                     7763.000000   
mean               266.380718                        1.819679   
min                252.400000                        0.100000   
25%                263.200000                        1.100000   
50%                265.600000                        1.600000   
75%                270.300000                        2.300000   
max                286.900000                       10.100000   
std                  4.230744                        1.437183   

       mean_vapor_pressure_deficit_7  relative_humidity_rmax_7  \
count                    7763.000000               7763.000000   
mean                        0.202857                 94.275024   
min                         0.000000                 19.300001   
25%                         0.140000                 96.700005   
50%                         0.150000                100.000000   
75%                         0.170000                100.000000   
max                         2.060000                100.000000   
std                         0.162456                 13.054587   

       relative_humidity_rmin_7  precipitation_amount_7  \
count               7763.000000             7763.000000   
mean                  50.984265                1.612970   
min                    1.900000                0.000000   
25%                   44.900000                0.000000   
50%                   51.400000                0.000000   
75%                   63.200000                2.000000   
max                  100.000000               72.800000   
std                   13.875185                6.076291   

       air_temperature_tmmx_7  wind_speed_7  fsca_7  
count             7763.000000   7763.000000  7763.0  
mean               274.734925      3.747929     0.0  
min                259.600000      1.000000     0.0  
25%                270.700000      2.600000     0.0  
50%                274.900000      3.300000     0.0  
75%                276.000000      4.500000     0.0  
max                296.700000     12.600000     0.0  
std                  4.490549      1.404623     0.0  
how many groups?  &lt;pandas.core.groupby.generic.DataFrameGroupBy object at 0x14f881310&gt;
This is the dataframe after cumulative columns are added
count    7763.0
mean        0.0
std         0.0
min         0.0
25%         0.0
50%         0.0
75%         0.0
max         0.0
Name: cumulative_fsca, dtype: float64
Index([&#39;date&#39;, &#39;lat&#39;, &#39;lon&#39;, &#39;SWE&#39;, &#39;station_name&#39;, &#39;swe_value&#39;,
       &#39;change_in_swe_inch&#39;, &#39;snow_depth&#39;, &#39;air_temperature_observed_f&#39;,
       &#39;air_temperature_tmmn&#39;,
       ...
       &#39;cumulative_SWE&#39;, &#39;cumulative_air_temperature_tmmn&#39;,
       &#39;cumulative_potential_evapotranspiration&#39;,
       &#39;cumulative_mean_vapor_pressure_deficit&#39;,
       &#39;cumulative_relative_humidity_rmax&#39;,
       &#39;cumulative_relative_humidity_rmin&#39;, &#39;cumulative_precipitation_amount&#39;,
       &#39;cumulative_air_temperature_tmmx&#39;, &#39;cumulative_wind_speed&#39;,
       &#39;cumulative_fsca&#39;],
      dtype=&#39;object&#39;, length=107)
All the cumulative variables are added successfully! ../data/final_merged_data_3yrs_all_active_stations_v1.csv_sorted.csv_cleaned_nodata.csv_time_series_cumulative_v1.csv
double check the swe_value statistics: count    7763.000000
mean        7.886990
std        12.707772
min         0.000000
25%         0.000000
50%         0.800000
75%        11.900000
max        74.600000
Name: swe_value, dtype: float64
</pre></div>
</div>
</div>
</div>
</section>
<section id="conclusion">
<h3>Conclusion<a class="headerlink" href="#conclusion" title="Link to this heading">#</a></h3>
<p>The script effectively prepares SWE and meteorological data for detailed time series analysis by systematically cleaning the data, handling missing values through interpolation, transforming the data into a time series format, and enriching the dataset with cumulative information. This preparation allows for a more accurate and insightful exploration of environmental and climatic dynamics.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./chapters"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="feat_selection.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Feature Selection for SWE Prediction Models</p>
      </div>
    </a>
    <a class="right-next"
       href="sanity_checks.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Sanity Checks</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#program-execution-flow">Program Execution Flow</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#importing-the-libraries-and-input-files">Importing the libraries and Input files</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cleaning-and-preparation">Cleaning and Preparation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#clean-non-swe-rows">clean_non_swe_rows</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpolation-and-missing-data-handling">Interpolation and Missing Data Handling</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#interpolate-missing-inplace">interpolate_missing_inplace</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#conversion-to-time-series-format">Conversion to Time Series Format</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#convert-to-time-series">convert_to_time_series</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#addition-of-cumulative-columns">Addition of Cumulative Columns</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#add-cumulative-columns">add_cumulative_columns</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#execution-and-output">Execution and Output</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Center for Spatial Information Science and Systems (CSISS), George Mason University
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>